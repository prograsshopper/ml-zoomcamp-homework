# 자동차 가격 예측 머신러닝 프로젝트 코드 설명

이 노트북은 **자동차 가격 예측을 위한 머신러닝 프로젝트**입니다. 진행 과정을 단계별로 설명합니다.

## 1. 데이터 로딩 및 전처리
- `data.csv` 파일에서 11,914개의 자동차 데이터 로드
- 컬럼명을 소문자로 변환하고 공백을 언더스코어로 교체
- 문자열 데이터도 동일하게 정규화

## 2. 탐색적 데이터 분석 (EDA)
- 각 컬럼의 고유값 개수와 데이터 타입 확인
- MSRP(제조사 권장 판매가) 분포 시각화
- Long tail 분포를 발견하고 로그 변환으로 정규분포화

## 3. 검증 프레임워크 설정
- 데이터를 train(60%), validation(20%), test(20%)로 분할
- 처음엔 순차적으로 분할했지만 브랜드가 편향되는 문제 발견
- `np.random.shuffle()`로 데이터 셔플링 후 재분할
- 재현성을 위해 `np.random.seed(2)` 설정

## 4. 선형 회귀 기초

### 데이터 준비 단계
```python
df_train.iloc[10]
```
- `iloc[10]`: 훈련 데이터에서 10번째 행(인덱스 10)의 자동차 정보를 가져옴
- 이 자동차는 Mazda 3, 2016년식, engine_hp=155, city_mpg=29, popularity=586

### 특성(Features) 선택
```python
xi = [155, 29, 586]
```
- `xi`: 선형회귀에 사용할 입력 특성들
- `155`: engine_hp (엔진 마력)
- `29`: city_mpg (시내 연비)
- `586`: popularity (인기도)
- 이 3개 숫자 특성을 사용해서 자동차 가격을 예측

### 모델 파라미터 설정
```python
w0 = 0
w = [0.01, 0.04, 0.002]
```
- `w0 = 0`: 편향(bias) 또는 절편(intercept). 기본값 0으로 설정
- `w = [0.01, 0.04, 0.002]`: 각 특성에 대한 가중치(weight)
  - `0.01`: engine_hp의 가중치
  - `0.04`: city_mpg의 가중치
  - `0.002`: popularity의 가중치

### 선형회귀 함수 정의
```python
def linear_regression(xi):
    n = len(xi)           # n = 3 (특성의 개수)
    pred = w0             # pred = 0으로 시작
    for j in range(n):    # j = 0, 1, 2에 대해 반복
        pred = pred + w[j] * xi[j]  # 각 특성 × 가중치를 누적
    return pred
```

**단계별 계산:**
- `j=0`: `pred = 0 + 0.01 * 155 = 1.55`
- `j=1`: `pred = 1.55 + 0.04 * 29 = 2.71`
- `j=2`: `pred = 2.71 + 0.002 * 586 = 3.882`

**수식으로 표현:**
```
예측값 = w0 + w1*x1 + w2*x2 + w3*x3 = 0 + 0.01*155 + 0.04*29 + 0.002*586
```

### 예측 실행
```python
linear_regression(xi)  # 결과: 3.8819999999999997
```
- 이 값은 **로그 변환된 가격**
- 실제 가격을 얻으려면 역변환이 필요

### 최종 가격 계산
```python
np.expm1(3.8819999999999997)  # 결과: 47.52116041451591
```
- `np.expm1()`: `np.log1p()`의 역함수
- 로그 변환된 예측값을 원래 가격($)으로 복원
- 결과: 약 $47,521 (실제로는 $47,521.16)

## 데이터 흐름 정리

### 실제 데이터의 흐름

1. **원본 데이터에서 특성 추출:**
```python
xi = [155, 29, 586]  # engine_hp, city_mpg, popularity
```
- 이 값들은 **원본 테이블에서 그대로 가져온 실제 값들**

2. **선형회귀 계산:**
```python
linear_regression(xi)  # 결과: 3.882
```
- 이 **3.882가 로그 변환된 가격**
- 왜냐하면 이 모델은 **로그 변환된 가격을 예측하도록 설계**되었기 때문

### 왜 로그 변환된 가격을 예측하는가?

노트북의 앞부분에서:
```python
y_train = np.log1p(df_train.msrp.values)  # 타겟 변수를 로그 변환
```

이 프로젝트는:
- **입력(X)**: 원본 특성 값들 (engine_hp=155, city_mpg=29, etc.)
- **출력(y)**: 로그 변환된 가격

따라서 모델이 예측하는 3.882는 로그 변환된 가격이고, 실제 달러 가격을 얻으려면 `np.expm1(3.882) = $47,521`로 역변환해야 합니다.

## 요약

이 선형회귀 모델은 엔진 마력, 시내 연비, 인기도 3개 특성을 사용해서 자동차 가격을 예측합니다. 임의로 설정한 가중치로 계산했을 때 이 Mazda 3의 예상 가격은 약 $47,521입니다.

**핵심**: 특성은 원본값 사용, 타겟만 로그 변환하여 학습하는 구조입니다.